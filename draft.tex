
\title{A Recurrence}
\author{
  Perry Kleinhenz \and
  Fermi Ma \and
  Erik Waingarten
}
\date{\today}

\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{amsthm}

\newtheorem{proposition}{Proposition}

\begin{document}
\maketitle

\section{Introduction}
\emph{Written by Erik Waingarten and Perry Kleinhenz, edited by Fermi Ma}

In this paper, we study recurrent sequences in which a the value of a term is defined as a function of the previous two terms. That is we consider sequences $a_0, a_1, a_2, \dots$ defined recursively using a function $F(x,y)$ of two variables, where we set
\begin{equation*}
a_{n+1} = F(a_n, a_{n-1}).
\end{equation*}
It is clear that any recurrence which depends on the previous two terms can be expressed in this form. For example the famous Fibonacci sequence fits this mold: if we define $F(x,y) = x + y$, then 
\begin{equation*}
a_{n+1} = a_n + a_{n-1},
\end{equation*}
and letting $a_0 =0 , a_1 = 1$, produces the Fibonacci sequence. 

In this paper we focus on whether or not a function $F$ will produce a sequence which is \emph{periodic} for any values of $a_0$ and $a_1$. In order to make this notion precise we give a formal definition.
\begin{definition}
A recurrence relation $F(x,y)$ is \textit{periodic} if  there exists an integer $n>0$ such that for any $x,y$, when $a_0 = x$ and $a_1 = y$ we have $a_n = x$ and $a_{n+1} = y$. The \emph{period} of $F$ is the smallest such $n$. 
\end{definition}

%We can compute some simple examples to promote our search. 
%\begin{itemize}
%\item $F(x,y) = y$: $x, y, x, y, x, \dots$, so we get period $2$.
%\item $F(x,y) = \dfrac{1}{xy}$: $x, y, \dfrac{1}{xy}, x, y, \dots$, so we get period $3$.
%\item $F(x,y) = \dfrac{1}{x}$: $x, y, \dfrac{1}{x}, \dfrac{1}{y}, x, y, \dots$, so we get period $4$.
%\end{itemize}

In Section 2 we explore a simplification of the question; we only consider $F$ of the form $F(x,y)=f(y)/x$. If we assume that $f$ is a polynomial we can completely classify such $F$ of period 2,3,4,5 and 6. We also show that for any $n>0$ we can produce a $f(y)$ such that $F$ has period $n$.  In Section 3 we look at another simplification of the question; we consider $F$ of the form $f(x,y)/g(x,y)$ where $f$ and $g$ are linear polynomials. We are able to completely describe $F$ of period 2 and 3. 

\section{The case of $F(x,y) = f(y)/x$}
\emph{Written by Erik Waingarten and Perry Kleinhenz, edited by Fermi Ma}

We begin by considering the special case where
\begin{equation}\label{eq:firstcase}
F(x,y) = \dfrac{f(y)}{x}
\end{equation}. 
In other words, the sequences are defined by the relation
\begin{equation*}
a_{n+1} = \dfrac{f(a_{n-1})}{a_n}
\end{equation*}
In the introduction, we've already seen two functions of this form that are periodic. Namely, $$f(y) = 1,$$ and $$f(y) = \frac{1}{y}.$$

At first glance it is unclear if using functions of this form we can produce a recurrence relation for an arbitrary period. It is also unclear if all functions of a particular period will take the same form. In this section we classify functions of the form of equation \ref{eq:firstcase} for period 2,3,4 and 5. 

\begin{proposition} 
There are no $F$ of the form in equation \ref{eq:firstcase} with period 2.
\end{proposition}
\begin{proof}
Assume otherwise so there is some $f$ of one variable that produces a recurrence relation of period 2. Then we must have 
\begin{equation*}
x = \frac{f(y)}{x},
\end{equation*}
or 
\begin{equation*}
x^2 = f(y).
\end{equation*}
Since this must hold for arbitrary $x$ and $y$, we can set $x=0$ and find that $f(y)=0$ for all $y$. But if we set $x=1$ we find that $f(y)=1$ for all $y$. This is a contradiction and so no such $f$ can exist.
\end{proof}



\begin{proposition}
If $F$ is of the form in equation ~\ref{eq:firstcase} and has period 3, then $F(x,y) = \dfrac{c}{xy}$.
\end{proposition}

\begin{proof}
Consider the first 4 terms of the :
\begin{equation*}
x, y, \dfrac{f(y)}{x}, x, y, \dots 
\end{equation*}
We note that $a_4=y$ and using the recurrence relation we find that 
\begin{equation*}
y = \dfrac{xf(x)}{f(y)},
\end{equation*}
and so,
\begin{equation*} 
y f(y) = x f(x).
\end{equation*}
Now if we fix $x = 1$, we have $y f(y) = f(1)$, and so $f(y) = \dfrac{c}{y}$, where $c$ is some constant .
\end{proof}

We can do a similar analysis for period $4$.
\begin{proposition}
f $F$ is of the form in equation ~\ref{eq:firstcase} and has period 4 and $f$ is a polynomial then $f(y) = c$. 
\end{proposition}

\begin{proof}
It is easy to check that these functions yield a sequence with period $4$, as they would form a sequence $x,y, \frac{c}{x}, \frac{c}{y}, x, y, \ldots$. 

Now suppose we have some non constant polynomial  $f$ that produces a sequence with period $4$. The  the first few terms of the sequence are 
\begin{equation*}
x, y, \dfrac{f(y)}{x}, \dfrac{f(f(y)/x)}{y}, x, y, \dots \, .
\end{equation*}
We note that $a_5 =y$ and using the recurrence relation we find that 
\begin{equation*}
 y = \dfrac{yf(x)}{f(f(y)/x)}, 
 \end{equation*}
simplifying gives us  
\begin{equation*}
 f(f(y)/x) = f(x).
\end{equation*}
If we fix $x = 1$, we have
\begin{equation*}
f(f(y)) = f(1). 
\end{equation*}
This means that $f(f(y))$ is a constant for every $y$. If we let $z=f(y)$ then we can see that $f(z)-f(1)$ is a polynomial in $z$ and has infinitely many roots. This is a contradiction as polynomials can only have finitely many roots. Therefore $f$ must be a constant. 
\end{proof}

We can also perform this analysis for period $5$  
\begin{proposition}
If $F$ is of the form in equation ~\ref{eq:firstcase} and has period 5 and $f$ is a polynomial then $f(y) = cy+c^2$. 
\end{proposition}
\begin{proof}
First we must show that $a_5=a_0$ and $a_6=a_1$. Well 
\begin{equation*}
a_2 = \frac{cy+c^2}{x},
\end{equation*}
and so 
\begin{equation*}
a_3 = \frac{ c \frac{cy+c^2}{x} +c^2}{y} = \frac{c^2y + c^3+c^3x}{xy},
\end{equation*}
so
\begin{equation*}
a_4  = \frac{c \frac{cy + c^2+c^2x}{xy} +c^2}{\frac{cy+c^2}{x}} = \frac{c^2y+c^2+c^2x+c^2xy}{y(cy+c^2)} = \frac{c(c+x)}{y},
\end{equation*}
giving us 
\begin{align*}
a_5 &=\left(c \frac{c(c+x)}{y} + c^2\right) \frac{xy}{c^2y+c^3+c^3x} = \frac{c^2y+c^3+c^3x}{y} \frac{xy}{c^2y+c^3+c^3x}= x.
\end{align*}
We can finally calculate $a_6$ and find 
\begin{align*}
a_6 = (cx + c^2) \frac{y}{cx+c^2} = y
\end{align*}
Therefore $f(y)=cy+c^2$ is periodic with period 5 as desired. Now we would like to show that all polynomial $f$ must be of this form. So if we consider an arbitrary $f$ we know that the first few terms of the sequence will be 
\begin{equation*}
x,y, \frac{f(y)}{x}, \frac{f(f(y)/x)}{y}, \frac{xf( f(f(y)/x)/y)}{f(y)}, x, y, \ldots
\end{equation*}
Now using the recurrence relation and setting $a_5=a$ and $a_6=y$, we obtain the relations
\begin{align*}
y &= \frac{ f(x)f(y)}{xf(f(f(y)/x)/y)} \\
x &= \frac{y f( xf(f(f(y)/x)/y)/f(y)}{f(f(y)/x)}.
\end{align*}
This gives us 
\begin{align*}
 \frac{f(x)}{y} &= \frac{ xf(f(f(y)/x)/y)}{f(y)} \\
xf\left(\frac{f(y)}{x}\right) &= y f\left( \frac{ xf(f(f(y)/x)/y)}{f(y)}\right).
\end{align*}
We note that the right hand side of the first equation can be plugged into the right hand side of the second equation to give us 
\begin{equation}
\label{period5relation}
xf\left(\frac{f(y)}{x}\right) = y f\left(\frac{f(x)}{y}\right).
\end{equation}
Now if $f$ is some polynomial it takes the form $f(z) = b_n z^n + \cdots + b_1 z + b_0$, with $b_n \neq 0$. Plugging this definition into Equation \ref{period5relation} gives us 
\begin{align*}
&x\left( b_n \left( \frac{f(y)}{x}\right)^n + \cdots + b_1 \left( \frac{f(y)}{x}\right) + b_0 \right) = \\
& y\left( b_n \left( \frac{f(x)}{y}\right)^n + \cdots + b_1 \left( \frac{f(x)}{y}\right) + b_0 \right). 
\end{align*}
Since $x$ and $y$ can take any values, we can set $x=1$ and let $y$ be arbitrary. The largest exponent of $y$ on the left hand side is $n^n$ while the largest exponent of $y$ on the right hand side is $1$. Since $y$ we can make it arbitrarily large so that the term with the largest exponent dominates, this gives us that $n^n=1$ so $n=1$ and $f(z) =b_1 z + b_0$. Plugging this back into Equation \ref{period5relation} gives us 
\begin{equation*}
x\left(b_1 \left( \frac{b_1 y + b_0}{x} \right) + b_0 \right) = y\left(b_1 \left( \frac{b_1 x + b_0}{y} \right) + b_0 \right),
\end{equation*}
which simplifies to 
\begin{equation*}
b_1^2 y + b_0 x = b_1^2 x + b_0 y.
\end{equation*}
Setting $x=0$ we must have $b_0=b_1^2$. Therefore in order for the recurrence relation to have period 5 we must have $f(z)=cy+c^2$, as desired. 
\end{proof}

We can also perform this analysis for period $6$  
\begin{proposition}
If $F$ is of the form in equation ~\ref{eq:firstcase} and has period 6 and $f$ is a polynomial then $f(y) = cy$. 
\end{proposition}
\begin{proof} 
It is simple to see that $f(y)=cy$ produces a recurrence of period 6. Now we would like to show that all polynomial $f$ must be of this form. If we consider some arbitrary $f$ we know that we must have 
\begin{align*}
a_6 =x = \frac{f(a_5)}{a_4} \\ 
a_7 = y = \frac{f(a_6)}{a_5},
\end{align*}
and so $a_5 = \frac{f(x)}{y}$. This also gives us that 
\begin{equation*}
a_4 x = f\left( \frac{f(x)}{y} \right).
\end{equation*}
Noting that 
\begin{equation*}
a_4 = \frac{ x f(f(f(y)/x)/y)}{f(y)}, 
\end{equation*}
we obtain 
\begin{equation}
\label{period6}
 f\left( \frac{f(x)}{y} \right) = \frac{ x^2 f(f(f(y)/x)/y)}{f(y)}.
\end{equation}
Since $x$ and $y$ can take any values, we can set $y=1$ and let $x$ be arbitrary. Furthermore since $f$ is some polynomial it takes the form $f(z) = b_n z^n + \cdots + b_1 z +b_0$. Plugging these two into Equation \ref{period6} gives us 
\begin{equation*}
f(b_n x^n + \cdots + b_1 x + b_0) = x^2 f\left( b_n \frac{f(1)^n}{x^n} + \cdots + b_1 \frac{f(1)}{x} + b_0 \right).
\end{equation*}
We note that the largest exponent of $x$ on the left hand side is $n^n$ while the largest exponent of $y$ on the right hand side is $x^2$ if $b_0 \neq 0$. Since we can make $x$ arbitrarily large so that the term with the largest exponent dominates, this gives us that we must have $n^n=2$ if $b \neq 0$. This equation has no integer solutions and so we must have $b_0 =0$. Now if $b_1 \neq 0$ the largest exponent on the right hand side is $1$ and $n^n=1$ is solved by $n=1$ and so $f(z) = b_1 z$ as desired. 
\end{proof}

\subsection{Generating Function for $\alpha_k$}
If we have the recurrence relation for $\alpha_k$ 
\begin{equation*}
\alpha_k = n \alpha_{k-1} - \alpha_{k-2}, 
\end{equation*}
we can use generating functions to find a closed form for $\alpha$. If we let $G(\xi)$ be the generating function of $\alpha_k$, that is 
\begin{equation*}
G(\xi) = \sum_{k=0}^{\infty} a_k \xi^k,
\end{equation*}
then using the above recurrence relation we know that 
\begin{equation*}
G(\xi) -\alpha_0 - \alpha_1 \xi = n \xi G(\xi) - \alpha_0 \xi - \xi^2 G(\xi).
\end{equation*}
W e can see that this holds as 
\begin{align*}
G(\xi) &= \alpha_0 + &\alpha_1 \xi + &\alpha_2 \xi^2 + \cdots \\
n \xi G(\xi) &= &n\alpha_0 \xi + &n\alpha_1 \xi^2 + n\alpha_2 \xi^3 + \cdots \\
\xi^2 G(\xi) &= &&\alpha_0 \xi^2 + \alpha_1 \xi^3 + \alpha_2 \xi^4 + \cdots.
\end{align*}
Therefore we can see 
\begin{equation*}
G( \xi) (1-n \xi + \xi^2) = n\alpha_0 + \alpha_1 \xi - n\alpha_0 \xi,
\end{equation*}
and so simplifying and using the fact that $\alpha_0=1, \alpha_1=0$ gives us 
\begin{equation*}
G(\xi) = \frac{ 1 - n\xi}{1 - n \xi + \xi^2} .
\end{equation*}
Now we recall that our goal is to establish what $n$ we must choose in order for our sequence to be periodic of period $p$. In order for this to occur we must have $\alpha_p= \alpha_0$ and $\alpha_{p+1} = \alpha_1$. This gives us that 
\begin{align*}
G(\xi) = &\alpha_0 + \alpha_1 \xi + \alpha_2 \xi^2 + \cdots + \alpha_{p-1} \xi^{p-1} \\
+ \alpha_p(&\alpha_0 + \alpha_1 \xi + \alpha_2 \xi^2 + \cdots + \alpha_{p-1} \xi^{p-1}) \\ 
+ \cdots 
\end{align*}
and so 
\begin{equation*}
G(\xi) = \frac{1}{1- \xi^p} (\alpha_0 + \alpha_1 \xi + \alpha_2 \xi^2 + \cdots + \alpha_{p-1} \xi^{p-1}).
\end{equation*}
Combining these two relations gives us that if our sequence is of period $p$ then 
\begin{equation*}
\frac{ 1 - n\xi}{1 - n \xi + \xi^2} = \frac{1}{1- \xi^p} (\alpha_0 + \alpha_1 \xi + \alpha_2 \xi^2 + \cdots + \alpha_{p-1} \xi^{p-1}).
\end{equation*}

We also know that since the $\alpha_k$ are the coefficients of the power series of $G(\xi)$ we know that 
\begin{equation*}
\alpha_k = \frac{1}{k!} \frac{d^k}{d \xi^k} G(\xi) |_{\xi=0}.
\end{equation*}


\section{Rational/Linear F}
\emph{Written by Perry Kleinhenz, edited by Fermi Ma and Erik Waingarten}
In this section we consider an $F$ which is a rational function composed of arbitrary linear functions. That is 
\begin{equation}
\label{rationallinear}
F(x,y) = \frac{ b_1 x + b_2 y + b_3}{ c_1 x+ c_2 y + c_3}
\end{equation}
Recall that our recurrence is $a_{n+1} = F( a_{n-1}, a_n)$. We can write out the first few terms of the sequence with arbitrary starting values $x,y$
\begin{align}
a_0 &= x \\ 
a_1 &=y \\
a_2 &= \frac{ b_1 x + b_2 y + b_3}{ c_1 x+ c_2 y + c_3}\\
\label{athree}a_3 &= \frac{(c_1 x+ c_2 y + c_3) b_1 y + b_2 (b_1 x + b_2 y + b_3)+ b_3(c_1 x+ c_2 y + c_3)}{ (c_1 x+ c_2 y + c_3)c_1 y+ c_2 (b_1 x + b_2 y + b_3) + c_3(c_1 x+ c_2 y + c_3)} \\
\vdots
\end{align}
These expressions get complicated very quickly, but we can use them to classify the periodic behavior of these functions.

It is somewhat obvious that $F(x,y)=x$ is the only ratio of linear functions that has period 2, however for larger $n$ the question and answer are slightly more interesting. 
\begin{proposition} 
If $F(x,y)$ is of the form in Equation \ref{rationallinear} and the recurrence relation it produces has period $3$ then $F$ is one of three following functions:
\begin{align*}
F(x,y) &= -x-y \\
F(x,y) &= \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) y \\
F(x,y) &= \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) y.
\end{align*}
\end{proposition}
\begin{proof}
In order for $F(x,y)$ to induce a recurrence relation with period $3$ we must have $a_3=a_0$. So using the expression in Equation \ref{athree} we must have 
\begin{align*}
\left( (c_1 x + c_2 y +c_3) c_1 y + c_2 (b_1 x + b_2 y + b_3) + c_3(c_1 x + c_2 y +c_3) \right) x = \\(c_1 x + c_2 y + c_3) b_1 y + b_2(b_1 x + b_2 y + b_3) + b_3 (c_1 x = c_2 y + c_3),
\end{align*}
If we multiply this expression out we get 
\begin{align*}
c_1^2 x^2 y + c_2 c_1 y^2 x + (c_3 c_1 + c_2 b_2 + c_3 c_2)xy + (c_2b_1 + c_3 c_1) x^2 + (b_3 + c_3)x = \\ c_1 b_1 xy + c_2 b_1 y^2 + c_3 b_1 y + (b_2 b_1 + b_3 c_1)x + (b_2^2 +b_3 c_2)y + b_2 b_3 + b_3 c_3.
\end{align*}
Because this relation must hold for arbitrary $x$ and $y$ we know that terms with the same exponents for $x$ and $y$ must cancel. So for instance we must have 
\begin{equation*}
c_1^2 x^2 y = 0, 
\end{equation*}
and so we must have $c_1=0$. We can do this for terms of each order and find the following 5 relations for the coefficients 
\begin{align}
\label{fiverelations}
c_2(b_2 + c_3) =0 \\
c_2 b_1 = 0 \\
b_3 + c_3 = b_2 b_1 \\
c_3 b_1 + b_2^2 + b_3 c_2 =0 \\
b_3(b_2 + c_3) = 0. 
\end{align}
Suppose that $c_2 =0$, then $F$ is of the form 
\begin{equation*}
F(x,y) = \frac{ b_1 x + b_2 y + b_3}{c_3}.
\end{equation*}
Therefore we must have 
\begin{equation*}
c_3^2 x = b_1 c_3 y + b_2 (b_1 x + b_2 y + b_3) + b_3,
\end{equation*}
which gives us a new family of relations 
\begin{align*}
b_2 b_1 = c_3^2 \\
c_3 b_1 + b_2^2 =0.
\end{align*}
Combining these two gives us 
\begin{equation*}
c_3^3 + b_2^3 = 0, 
\end{equation*}
which has three solutions $c_3 = -b_2$ and $c_3 = \frac{1}{2} ( b_2 \pm i\sqrt{3}b_2)$. Note that $c_3 = -b_2$ implies that we must have $b_1=b_2$ which gives us $F(x,y) = -x -y$. It is easy to check that this is in fact periodic with period 3. On the other hand $c_3 = \frac{1}{2} ( b_2 \pm i\sqrt{3}b_2)$ implies that $b_1 = \frac{1}{2} ( -b_2 \pm i\sqrt{3}b_2)$, which gives us 
\begin{align*}
F(x,y) &= \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) y \\
F(x,y) &= \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) y.
\end{align*}
It is also easy to check that these two $F$ have period 3. This exhausts the possibilities when $c_2=0$ so let us asssume otherwise. Then based on the relations \ref{fiverelations} we must have 
\begin{equation*}
b_1 = 0,
\end{equation*}
and so $F(x,y)$ takes the form 
\begin{equation*}
F(x,y) = \frac{b_2 y + b_3}{c_2 y + c_3}.
\end{equation*}
Therefore if $a_3 = a_0$ we must have that 
\begin{equation*}
x = \frac{ b_2^2 y + b_2b_3 +b_3(c_2 y + c_3)}{c_2 b_2 y + c_2 b_3 + c_3 c_2 y + c_3^2},
\end{equation*}
but the left hand side depends only on $x$ and the right hand side depends only on $y$. This relation cannot hold for arbitrary $x,y$ and so we cannot have such $F$. Therefore we must have $c_2=0$ and so the only $F$ with period 3 are the ones we have given. 
\end{proof}
\end{document}
