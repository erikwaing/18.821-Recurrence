
\title{A Recurrence}
\author{
  Perry Kleinhenz \and
  Fermi Ma \and
  Erik Waingarten
}
\date{\today}

\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{amsthm}

\newtheorem{proposition}{Proposition}

\begin{document}
\maketitle

\section{Introduction}
\emph{Written by Erik Waingarten}

In this paper, we will study recurrences with \textit{memory two}. By memory two, we mean that the sequence can be described by a recurrence where a certain number depends on the previous two numbers. We can define a sequence $a_0, a_1, a_2, \dots$ recursively using a function $F(x,y)$ of two variables, where we assign
\[ a_{n+1} = F(a_n, a_{n-1}) \]
Note that this is the ultimate generalization of recurrences which depends on the previous two terms. The famous Fibonacci sequence fits this mold: we can let $F(x,y) = x + y$, and the recurrence will yield
\[ a_{n+1} = a_n + a_{n-1} \]
If we let $a_0 = a_1 = 1$, we get the Fibonacci sequence. In this paper, we will focus on the properties that arise out of different definitions of the functions $F(x,y)$, independent of the intial terms. So usually, we will let $a_0 = x$ and $a_1 = y$, and we assume that $x$ and $y$ can take on any values. We will say that a recursive definition is \textit{periodic} if, with indeterminate intiail values $a_0 = x$ and $a_1 = y$, there is an integer $n>0$ such that $a_n = x$ and $a_{n+1} = y$. The \emph{period} is the smallest such $n$. 

We can compute some simple examples to promote our search. 
\begin{itemize}
\item $F(x,y) = y$: $x, y, x, y, x, \dots$, so we get period $2$.
\item $F(x,y) = \dfrac{1}{xy}$: $x, y, \dfrac{1}{xy}, x, y, \dots$, so we get period $3$.
\item $F(x,y) = \dfrac{1}{x}$: $x, y, \dfrac{1}{x}, \dfrac{1}{y}, x, y, \dots$, so we get period $4$.
\end{itemize}

There are some functions $F(x,y)$ such as the one generating the Fibonacci sequence which do not yield periodic sequences. One can ask, is there a simple test that determines whether a function yields a periodic sequence? Can we characterize the such functions? What are the possible periods?

These are questions that we hope to answer. 

\section{The case of $F(x,y) = f(y)/x$}
\emph{Written by Erik Waingarten, edited by Perry Kleinhenz and Fermi Ma}

We begin by considering the special case where 
\begin{equation}\label{eq:firstcase}
F(x,y) = \dfrac{f(y)}{x}
\end{equation}. In other words, the sequences are defined by the relation
\begin{equation*}
a_{n+1} = \dfrac{f(a_{n-1})}{a_n}
\end{equation*}
In the introduction, we've already seen two functions of this form that are periodic. Namely, $f(y) = 1$ and $f(y) = \frac{1}{y}$. 

\begin{proposition}
If $F$ is of the form in equation ~\ref{eq:firstcase} and has period 3, then $F(x,y) = \dfrac{c}{xy}$.
\end{proposition}

\begin{proof}
Consider the first 4 terms of the :
\begin{equation*}
x, y, \dfrac{f(y)}{x}, x, y, \dots 
\end{equation*}
We note that $a_4=y$ and using the recurrence relation we find that 
\begin{equation*}
y = \dfrac{xf(x)}{f(y)},
\end{equation*}
and so,
\begin{equation*} 
y f(y) = x f(x).
\end{equation*}
Now if we fix $x = 1$, we have $y f(y) = f(1)$, and so $f(y) = \dfrac{c}{y}$, where $c$ is some constant .
\end{proof}

We can do a similar analysis for period $4$.
\begin{proposition}
f $F$ is of the form in equation ~\ref{eq:firstcase} and has period 4 and $f$ is a polynomial then $f(y) = c$. 
\end{proposition}

\begin{proof}
It is easy to check that these functions yield a sequence with period $4$, as they would form a sequence $x,y, \frac{c}{x}, \frac{c}{y}, x, y, \ldots$. 

Now suppose we have some non constant polynomial  $f$ that produces a sequence with period $4$. The  the first few terms of the sequence are 
\begin{equation*}
x, y, \dfrac{f(y)}{x}, \dfrac{f(f(y)/x)}{y}, x, y, \dots \, .
\end{equation*}
We note that $a_5 =y$ and using the recurrence relation we find that 
\begin{equation*}
 y = \dfrac{yf(x)}{f(f(y)/x)}, 
 \end{equation*}
simplifying gives us  
\begin{equation*}
 f(f(y)/x) = f(x).
\end{equation*}
If we fix $x = 1$, we have
\begin{equation*}
f(f(y)) = f(1). 
\end{equation*}
This means that $f(f(y))$ is a constant for every $y$. If we let $z=f(y)$ then we can see that $f(z)-f(1)$ is a polynomial in $z$ and has infinitely many roots. This is a contradiction as polynomials can only have finitely many roots. Therefore $f$ must be a constant. 
\end{proof}

We can also perform this analysis for period $5$  
\begin{proposition}
If $F$ is of the form in equation ~\ref{eq:firstcase} and has period 4 and $f$ is a polynomial then $f(y) = cy+c^2$
\end{proposition}
\begin{proof}
First we must show that $a_5=a_0$ and $a_6=a_1$. Well 
\begin{equation*}
a_2 = \frac{cy+c^2}{x},
\end{equation*}
and so 
\begin{equation*}
a_3 = \frac{ c \frac{cy+c^2}{x} +c^2}{y} = \frac{c^2y + c^3+c^3x}{xy},
\end{equation*}
so
\begin{equation*}
a_4  = \frac{c \frac{cy + c^2+c^2x}{xy} +c^2}{\frac{cy+c^2}{x}} = \frac{c^2y+c^2+c^2x+c^2xy}{y(cy+c^2)} = \frac{c(c+x)}{y},
\end{equation*}
giving us 
\begin{align*}
a_5 &=\left(c \frac{c(c+x)}{y} + c^2\right) \frac{xy}{c^2y+c^3+c^3x} = \frac{c^2y+c^3+c^3x}{y} \frac{xy}{c^2y+c^3+c^3x}= x.
\end{align*}
We can finally calculate $a_6$ and find 
\begin{align*}
a_6 = (cx + c^2) \frac{y}{cx+c^2} = y
\end{align*}
Therefore $f(y)=cy+c^2$ is periodic with period 5 as desired. 
\end{proof}


\section{Rational/Linear F}
In this section we consider an $F$ which is a rational function composed of arbitrary linear functions. That is 
\begin{equation}
\label{rationallinear}
F(x,y) = \frac{ b_1 x + b_2 y + b_3}{ c_1 x+ c_2 y + c_3}
\end{equation}
Recall that our recurrence is $a_{n+1} = F( a_{n-1}, a_n)$. We can write out the first few terms of the sequence with arbitrary starting values $x,y$
\begin{align}
a_0 &= x \\ 
a_1 &=y \\
a_2 &= \frac{ b_1 x + b_2 y + b_3}{ c_1 x+ c_2 y + c_3}\\
\label{athree}a_3 &= \frac{(c_1 x+ c_2 y + c_3) b_1 y + b_2 (b_1 x + b_2 y + b_3)+ b_3(c_1 x+ c_2 y + c_3)}{ (c_1 x+ c_2 y + c_3)c_1 y+ c_2 (b_1 x + b_2 y + b_3) + c_3(c_1 x+ c_2 y + c_3)} \\
\vdots
\end{align}
These expressions get complicated very quickly, but we can use them to classify the periodic behavior of these functions.

It is somewhat obvious that $F(x,y)=x$ is the only ratio of linear functions that has period 2, however for larger $n$ the question and answer are slightly more interesting. 
\begin{proposition} 
If $F(x,y)$ is of the form in Equation \ref{rationallinear} and the recurrence relation it produces has period $3$ then $F$ is one of three following functions:
\begin{align*}
F(x,y) &= -x-y \\
F(x,y) &= \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) y \\
F(x,y) &= \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) y.
\end{align*}
\end{proposition}
\begin{proof}
In order for $F(x,y)$ to induce a recurrence relation with period $3$ we must have $a_3=a_0$. So using the expression in Equation \ref{athree} we must have 
\begin{align*}
\left( (c_1 x + c_2 y +c_3) c_1 y + c_2 (b_1 x + b_2 y + b_3) + c_3(c_1 x + c_2 y +c_3) \right) x = \\(c_1 x + c_2 y + c_3) b_1 y + b_2(b_1 x + b_2 y + b_3) + b_3 (c_1 x = c_2 y + c_3),
\end{align*}
If we multiply this expression out we get 
\begin{align*}
c_1^2 x^2 y + c_2 c_1 y^2 x + (c_3 c_1 + c_2 b_2 + c_3 c_2)xy + (c_2b_1 + c_3 c_1) x^2 + (b_3 + c_3)x = \\ c_1 b_1 xy + c_2 b_1 y^2 + c_3 b_1 y + (b_2 b_1 + b_3 c_1)x + (b_2^2 +b_3 c_2)y + b_2 b_3 + b_3 c_3.
\end{align*}
Because this relation must hold for arbitrary $x$ and $y$ we know that terms with the same exponents for $x$ and $y$ must cancel. So for instance we must have 
\begin{equation*}
c_1^2 x^2 y = 0, 
\end{equation*}
and so we must have $c_1=0$. We can do this for terms of each order and find the following 5 relations for the coefficients 
\begin{align}
\label{fiverelations}
c_2(b_2 + c_3) =0 \\
c_2 b_1 = 0 \\
b_3 + c_3 = b_2 b_1 \\
c_3 b_1 + b_2^2 + b_3 c_2 =0 \\
b_3(b_2 + c_3) = 0. 
\end{align}
Suppose that $c_2 =0$, then $F$ is of the form 
\begin{equation*}
F(x,y) = \frac{ b_1 x + b_2 y + b_3}{c_3}.
\end{equation*}
Therefore we must have 
\begin{equation*}
c_3^2 x = b_1 c_3 y + b_2 (b_1 x + b_2 y + b_3) + b_3,
\end{equation*}
which gives us a new family of relations 
\begin{align*}
b_2 b_1 = c_3^2 \\
c_3 b_1 + b_2^2 =0.
\end{align*}
Combining these two gives us 
\begin{equation*}
c_3^3 + b_2^3 = 0, 
\end{equation*}
which has three solutions $c_3 = -b_2$ and $c_3 = \frac{1}{2} ( b_2 \pm i\sqrt{3}b_2)$. Note that $c_3 = -b_2$ implies that we must have $b_1=b_2$ which gives us $F(x,y) = -x -y$. It is easy to check that this is in fact periodic with period 3. On the other hand $c_3 = \frac{1}{2} ( b_2 \pm i\sqrt{3}b_2)$ implies that $b_1 = \frac{1}{2} ( -b_2 \pm i\sqrt{3}b_2)$, which gives us 
\begin{align*}
F(x,y) &= \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) y \\
F(x,y) &= \left( \frac{1}{2} +\frac{i\sqrt{3}}{2} \right) x + \left( \frac{1}{2} -\frac{i\sqrt{3}}{2} \right) y.
\end{align*}
It is also easy to check that these two $F$ have period 3. This exhausts the possibilities when $c_2=0$ so let us asssume otherwise. Then based on the relations \ref{fiverelations} we must have 
\begin{equation*}
b_1 = 0,
\end{equation*}
and so $F(x,y)$ takes the form 
\begin{equation*}
F(x,y) = \frac{b_2 y + b_3}{c_2 y + c_3}.
\end{equation*}
Therefore if $a_3 = a_0$ we must have that 
\begin{equation*}
x = \frac{ b_2^2 y + b_2b_3 +b_3(c_2 y + c_3)}{c_2 b_2 y + c_2 b_3 + c_3 c_2 y + c_3^2},
\end{equation*}
but the left hand side depends only on $x$ and the right hand side depends only on $y$. This relation cannot hold for arbitrary $x,y$ and so we cannot have such $F$. Therefore we must have $c_2=0$ and so the only $F$ with period 3 are the ones we have given. 
\end{proof}


\end{document}
